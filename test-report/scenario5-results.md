# 시나리오 5: 지속적 부하 테스트

**테스트 일시**: 2026-01-06
**테스트 조건**: 50 req/sec, 2분 (원래 목표: 1,000 req/sec, 10분)

---

## 테스트 목적

장시간 운영 시 시스템 안정성 및 리소스 누수 확인 (테스트용 축소)
- 완전한 E2E 사용자 여정 측정 (대기열 → 예약 → 결제)
- 지속 부하 시 성능 저하 모니터링

---

## 핵심 결과

### ✅ 우수한 API 성능

| 지표 | 결과 | 평가 |
|------|------|------|
| **P95 응답시간** | **6.82ms** | ✅ 목표(500ms) 대비 98.6% 개선 |
| **HTTP 성공률** | **100%** (11,176건) | ✅ 완벽 |
| **HTTP 처리량** | **84.33 req/sec** | ✅ 양호 |
| **토큰 발급 성공률** | **100%** (1,016건) | ✅ 완벽 |
| **평균 응답시간** | **4.49ms** | ✅ 매우 빠름 |

### ❌ 차단 이슈

**E2E 사용자 여정 실패**
- **E2E 성공률**: 0% (1,016건 모두 실패)
- **대기열 에러**: 1,016건 (대기열 활성화 타임아웃)
- **드롭된 요청**: 4,985건 (83% 드롭율 - VU 부족)

---

## 상세 메트릭

```
총 HTTP 요청: 11,176건
HTTP 처리량: 84.33 req/sec

HTTP 응답 시간:
  - 평균: 4.49ms
  - 최소: 1.74ms
  - 최대: 101.08ms
  - P90: 5.87ms
  - P95: 6.82ms

E2E 사용자 여정:
  - 완료된 여정: 1,016건
  - 성공한 여정: 0건 (0%)
  - 실패 원인: 대기열 활성화 타임아웃
  - E2E 소요 시간: 평균 10,056ms (~10초)

시스템 리소스:
  - VUs: 최대 100 (한계 도달)
  - 메모리 사용량: 평균 12.5 MB (100 VUs 기준)
  - Active Connections: 평균 25
```

---

## 문제 분석

### ❌ 대기열 활성화 타임아웃 (CRITICAL)
- 모든 사용자 여정이 대기열 활성화 단계에서 실패
- 1,016건의 토큰 발급 성공 → 0건의 ACTIVE 상태 전환
- 시나리오 1, 2와 동일한 이슈

### ⚠️ VU 부족으로 인한 높은 드롭율 (83%)
- 각 iteration이 평균 12초 소요 (대기열 대기 10초 포함)
- 50 req/sec 유지를 위해 600 VUs 필요 (50 * 12초)
- 실제 maxVUs는 100으로 설정되어 부족
- **해결 방안**: maxVUs를 500~1000으로 증가

---

## 측정 가능했던 성능

### 1. API 응답 성능
- P95 응답 시간: **6.82ms** (목표 대비 98.6% 개선)
- HTTP 성공률: **100%**
- 시스템 크래시 없음

### 2. 시스템 안정성
- 2분간 지속 부하 유지
- 메모리 사용량 안정적
- 메모리 누수 징후 없음 (테스트 기간 한정)

---

## 측정하지 못한 항목

대기열 활성화 차단으로 다음 항목 미측정:
- ❌ 콘서트 정보 조회 성능
- ❌ 포인트 충전 성능
- ❌ 좌석 예약 성능
- ❌ 결제 처리 성능
- ❌ 장기간 운영 시 리소스 누수
- ❌ E2E 사용자 여정 응답 시간

---

## 다음 단계

**즉시 조치**:
1. 대기열 스케줄러 로직 수정
2. VU 설정 증가 (maxVUs: 500~1000)

**이슈 해결 후**:
1. 시나리오 5 재실행 (1,000 req/sec, 10분)
2. 장기간 운영 시 메모리 사용량 추이 모니터링
3. E2E 사용자 여정 성공률 및 응답 시간 측정

---

**보고서 작성**: 2026-01-06
**상태**: ❌ 차단 이슈 (대기열 활성화)
