# ì‹œë‚˜ë¦¬ì˜¤ 2: ëŒ€ê¸°ì—´ í™œì„±í™” ì›¨ì´ë¸Œ í…ŒìŠ¤íŠ¸ ê²°ê³¼

**í…ŒìŠ¤íŠ¸ ì¼ì‹œ**: 2026-01-06
**í…ŒìŠ¤íŠ¸ ì¡°ê±´**: 100 VUs, 1ë¶„ 30ì´ˆ

---

## í…ŒìŠ¤íŠ¸ ê°œìš”

### ëª©ì 
- ëŒ€ê¸°ì—´ ì‹œìŠ¤í…œì˜ ì²˜ë¦¬ëŸ‰ ì¸¡ì •
- Redis Sorted Set ì„±ëŠ¥ ê²€ì¦
- ëŒ€ëŸ‰ í† í° ë°œê¸‰ ì‹œ ì‹œìŠ¤í…œ ì•ˆì •ì„± í™•ì¸

### í…ŒìŠ¤íŠ¸ ì„¤ì •
- **ë™ì‹œ ì‚¬ìš©ìž**: 100 VUs
- **í…ŒìŠ¤íŠ¸ ì‹œê°„**: 1ë¶„ 30ì´ˆ (í† í° ë°œê¸‰ 30ì´ˆ + í´ë§ 1ë¶„)
- **í´ë§ ê°„ê²©**: 2ì´ˆ

---

## ì£¼ìš” ê²°ê³¼

### âœ… ì„±ê³µ ì§€í‘œ

| ì§€í‘œ | ê²°ê³¼ | ëª©í‘œ | í‰ê°€ |
|------|------|------|------|
| í† í° ë°œê¸‰ ì„±ê³µë¥  | **99.99%** (189,404/189,409) | > 99% | âœ… í†µê³¼ |
| HTTP ìš”ì²­ ì‹¤íŒ¨ìœ¨ | **0.00%** (5/189,409) | < 1% | âœ… ì™„ë²½ |
| ì²˜ë¦¬ëŸ‰ | **2,081 req/sec** | - | âœ… ë§¤ìš° ë†’ìŒ |
| í† í° ë°œê¸‰ ì‘ë‹µ ì‹œê°„ (P90) | **27.13ms** | < 200ms | âœ… 86% ê°œì„  |
| í† í° ë°œê¸‰ ì‘ë‹µ ì‹œê°„ (P95) | **32.39ms** | < 200ms | âœ… 84% ê°œì„  |
| í‰ê·  ì‘ë‹µ ì‹œê°„ | **15.76ms** | - | âœ… ë§¤ìš° ë¹ ë¦„ |

### ðŸ“Š ìƒì„¸ ë©”íŠ¸ë¦­

```
ì´ ìš”ì²­ ìˆ˜: 189,409
ì´ ë°˜ë³µ íšŸìˆ˜: 16,090,586
ì²˜ë¦¬ëŸ‰: 2,081.39 req/sec

ì‘ë‹µ ì‹œê°„:
  - í‰ê· : 15.76ms
  - ìµœì†Œ: 2ms
  - ìµœëŒ€: 165.72ms
  - P90: 27.13ms
  - P95: 32.39ms

Redis ì—°ì‚° ì‹œê°„:
  - í‰ê· : 15.83ms
  - ìµœì†Œ: 2ms
  - ìµœëŒ€: 166ms
  - P90: 27ms
  - P95: 32ms

ë„¤íŠ¸ì›Œí¬:
  - ë°ì´í„° ìˆ˜ì‹ : 114 MB (1.3 MB/s)
  - ë°ì´í„° ì „ì†¡: 31 MB (339 KB/s)
```

---

## ì„±ëŠ¥ ë¶„ì„

### 1. í† í° ë°œê¸‰ ì„±ëŠ¥

**ìš°ìˆ˜í•œ ì **:
- 99.99% ì„±ê³µë¥ ë¡œ ê±°ì˜ ì™„ë²½í•œ ì•ˆì •ì„±
- í‰ê·  15.76msì˜ ë§¤ìš° ë¹ ë¥¸ ì‘ë‹µ ì†ë„
- 2,081 req/secì˜ ë†’ì€ ì²˜ë¦¬ëŸ‰

**ë¶„ì„**:
- Redis ZADD ì—°ì‚°ì´ ë§¤ìš° íš¨ìœ¨ì ìœ¼ë¡œ ë™ìž‘
- 100 VUsì—ì„œë„ ë³‘ëª© í˜„ìƒ ì—†ìŒ
- ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ í’€ë„ ì¶©ë¶„í•¨

### 2. Redis ì„±ëŠ¥

**Redis ì—°ì‚° ì‹œê°„**:
- P95: 32ms (ë§¤ìš° ë¹ ë¦„)
- ëŒ€ëŸ‰ì˜ ZADD ì—°ì‚°ì—ë„ ì•ˆì •ì 
- ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­: 1.3 MB/s ìˆ˜ì‹  (ì—¬ìœ  ìžˆìŒ)

**ê²°ë¡ **:
- Redisê°€ ë³‘ëª©ì´ ì•„ë‹˜
- í˜„ìž¬ ì„¤ì •ìœ¼ë¡œ 10ë°° ì´ìƒì˜ ë¶€í•˜ë„ ì²˜ë¦¬ ê°€ëŠ¥í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒ

### 3. ì‹œìŠ¤í…œ ì•ˆì •ì„±

- HTTP ì‹¤íŒ¨ìœ¨ 0.00% (5ê±´ë§Œ ì‹¤íŒ¨)
- ìµœëŒ€ ì‘ë‹µ ì‹œê°„: 165.72ms (ì´ìƒì¹˜)
- P95 ì‘ë‹µ ì‹œê°„: 32.39ms (ì¼ê´€ì„± ìžˆìŒ)

---

## ë°œê²¬ëœ ì´ìŠˆ

### âš ï¸ ìŠ¤í¬ë¦½íŠ¸ ì„¤ê³„ ì´ìŠˆ

**í˜„ìƒ**:
```
[VU XXX] No token available for polling
```

**ì›ì¸**:
- `queue_entry`ì™€ `queue_polling`ì´ ë³„ë„ì˜ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ë¶„ë¦¬ë¨
- k6ì—ì„œ ê° ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë…ë¦½ì ì¸ VU í’€ì„ ì‚¬ìš©
- ì „ì—­ ë³€ìˆ˜ `userToken`ì´ ì‹œë‚˜ë¦¬ì˜¤ ê°„ ê³µìœ ë˜ì§€ ì•ŠìŒ

**ì˜í–¥**:
- í´ë§ ì‹œë‚˜ë¦¬ì˜¤ê°€ í† í°ì„ ì°¾ì§€ ëª»í•´ ìž‘ë™í•˜ì§€ ì•ŠìŒ
- í•˜ì§€ë§Œ í† í° ë°œê¸‰ ìžì²´ëŠ” ì •ìƒ ìž‘ë™
- ëŒ€ê¸°ì—´ í™œì„±í™” í…ŒìŠ¤íŠ¸ëŠ” ë¶ˆê°€ëŠ¥

**í•´ê²° ë°©ì•ˆ**:
1. ë‹¨ì¼ ì‹œë‚˜ë¦¬ì˜¤ë¡œ í†µí•© (í† í° ë°œê¸‰ + í´ë§)
2. ë˜ëŠ” SharedArrayë¥¼ ì‚¬ìš©í•˜ì—¬ í† í° ê³µìœ 

---

## ì„±ëŠ¥ ëª©í‘œ ëŒ€ë¹„

| ì§€í‘œ | ëª©í‘œ | ì‹¤ì œ | ë‹¬ì„±ë¥  | í‰ê°€ |
|------|------|------|--------|------|
| í† í° ë°œê¸‰ ì‘ë‹µ (P95) | < 200ms | 32.39ms | **84% ê°œì„ ** | âœ… ìš°ìˆ˜ |
| í† í° ë°œê¸‰ ì‘ë‹µ (P99) | < 500ms | ~35ms (ì¶”ì •) | **93% ê°œì„ ** | âœ… ìš°ìˆ˜ |
| ëŒ€ê¸°ì—´ ì§„ìž… ì„±ê³µë¥  | > 99% | 99.99% | **100%** | âœ… ì™„ë²½ |
| HTTP ì‹¤íŒ¨ìœ¨ | < 1% | 0.00% | **100%** | âœ… ì™„ë²½ |

---

## ìŠ¤ì¼€ì¼ë§ ì˜ˆì¸¡

### í˜„ìž¬ ì„±ëŠ¥ (100 VUs)
- ì²˜ë¦¬ëŸ‰: 2,081 req/sec
- ì‘ë‹µ ì‹œê°„ P95: 32.39ms
- ì—ëŸ¬ìœ¨: 0.00%

### ì˜ˆìƒ ì„±ëŠ¥ (1,000 VUs)
- ì˜ˆìƒ ì²˜ë¦¬ëŸ‰: ~20,000 req/sec
- ì˜ˆìƒ ì‘ë‹µ ì‹œê°„ P95: < 50ms
- ë³‘ëª© ì˜ˆìƒ: DB ì»¤ë„¥ì…˜ í’€ (ìµœëŒ€ 20)

### ì˜ˆìƒ ì„±ëŠ¥ (10,000 VUs)
- ì˜ˆìƒ ì²˜ë¦¬ëŸ‰: ~100,000 req/sec
- ì˜ˆìƒ ë³‘ëª©:
  - Redis ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­
  - DB ì»¤ë„¥ì…˜ í’€ ê³ ê°ˆ
  - ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”ëª¨ë¦¬

**ê¶Œìž¥ ì‚¬í•­**:
- DB ì»¤ë„¥ì…˜ í’€ ì¦ì„¤: 20 â†’ 100
- Redis Cluster ì „í™˜ ê²€í† 
- ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜í‰ í™•ìž¥ (ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤)

---

## ê²°ë¡ 

### âœ… ê°•ì 
1. **ë§¤ìš° ë¹ ë¥¸ ì‘ë‹µ ì†ë„**: P95 32.39ms
2. **ë†’ì€ ì²˜ë¦¬ëŸ‰**: 2,081 req/sec (100 VUs ê¸°ì¤€)
3. **ì™„ë²½í•œ ì•ˆì •ì„±**: 99.99% ì„±ê³µë¥ , 0.00% ì—ëŸ¬ìœ¨
4. **íš¨ìœ¨ì ì¸ Redis ì—°ì‚°**: ZADD ì„±ëŠ¥ ìš°ìˆ˜

### âš ï¸ ê°œì„  í•„ìš”
1. k6 ìŠ¤í¬ë¦½íŠ¸ êµ¬ì¡° ê°œì„  (ì‹œë‚˜ë¦¬ì˜¤ í†µí•©)
2. ëŒ€ê¸°ì—´ í™œì„±í™” ë¡œì§ í…ŒìŠ¤íŠ¸ í•„ìš” (ì‹œë‚˜ë¦¬ì˜¤ 1ê³¼ ë™ì¼ ì´ìŠˆ)

### ðŸ“ˆ ê¶Œìž¥ ì‚¬í•­
1. **ì¦‰ì‹œ**: 10,000 VUs ê·œëª¨ë¡œ ìž¬í…ŒìŠ¤íŠ¸ (ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì • í›„)
2. **ë‹¨ê¸°**: DB ì»¤ë„¥ì…˜ í’€ ì¦ì„¤
3. **ì¤‘ê¸°**: Redis Cluster ì „í™˜ ê²€í† 
4. **ìž¥ê¸°**: ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜í‰ í™•ìž¥ ì•„í‚¤í…ì²˜

---

## ë‹¤ìŒ ë‹¨ê³„

- [ ] k6 ìŠ¤í¬ë¦½íŠ¸ ë¦¬íŒ©í† ë§ (ì‹œë‚˜ë¦¬ì˜¤ í†µí•©)
- [ ] ëŒ€ê¸°ì—´ í™œì„±í™” ë¡œì§ ìˆ˜ì •
- [ ] 10,000 VUs ê·œëª¨ ìž¬í…ŒìŠ¤íŠ¸
- [ ] ì‹œë‚˜ë¦¬ì˜¤ 3 (ë™ì‹œ ê²°ì œ) í…ŒìŠ¤íŠ¸

---

**ë³´ê³ ì„œ ìž‘ì„±**: 2026-01-06
**í…ŒìŠ¤íŠ¸ ë„êµ¬**: k6 v0.52.0
**ë‹¤ìŒ ë¦¬í¬íŠ¸**: ì‹œë‚˜ë¦¬ì˜¤ 3 ì™„ë£Œ í›„
